// generate svg based on a 100x100 viewport

const TOTAL_HEIGHT = 100
let maskCounter = 0 // ensure unique mask ids

export default function generateSVG (options) {
	const colors = options.colors.slice()
	const {transform, mask, addLogo} = options
	const stripeCurve = options.stripeCurve || 'l 100 0'
	let output = ''

	const stripeSize = TOTAL_HEIGHT / options.colors.reduce((acc, {ratio}) => acc + ratio, 0)
	// use mask instead of clip to avoid ragged edges
	maskCounter++
	if (mask) {
		output += `<mask id="mask-${maskCounter}">${mask}</mask>`
	}
	output += `<g transform="${transform}"`
	if (mask) {
		output += ` mask="url(#mask-${maskCounter})"`
	}
	output += '>'
	// output colors in reverse order for first color to be on top
	// last color needs no path
	const lastColor = colors.pop()
	output += `<rect width="100" height="100" fill="${lastColor.color}" />`
	let stripePos = 100 - stripeSize * lastColor.ratio
	for (let i = colors.length - 1; i >= 0; i--) {
		const color = colors[i]
		output += `<path d="M 0 0 L 0 ${stripePos} ${stripeCurve} L 100 0" fill="${color.color}" />`
		stripePos -= stripeSize * color.ratio
	}

	output += `</g>`
	if (addLogo) {
		output += logo
	}
	return output
}

const logo = '<g transform="matrix(.55003 0 0 .55003 -6.1312 51.114)"><path d="m102.05-81.526c-21.09 0-41.308 8.3778-56.218 23.283-14.911 14.909-23.283 35.133-23.283 56.218 0 43.907 35.593 79.5 79.5 79.5 43.907-1e-5 79.499-35.593 79.499-79.5 0-43.907-35.591-79.501-79.499-79.501zm-.007 1.9519c42.831 0 77.548 34.723 77.548 77.548 0 42.831-34.717 77.548-77.548 77.548-42.825 0-77.542-34.717-77.542-77.548 0-42.825 34.717-77.548 77.542-77.548z" style="fill-rule:evenodd;fill:#fff;stroke-width:1.0994"/><path d="m41.868 46.78c15.106-3.7335 36.544-6.0643 60.307-6.0643 23.769 0 45.201 2.3307 60.307 6.0643-13.061 17.269-35.21 28.642-60.307 28.642-25.097 0-47.239-11.372-60.307-28.642z" style="fill-rule:evenodd;fill:#57da00;stroke-width:1.4659"/><path d="m137.63 24.762-1.5274-1.523h-68.765l-1.5289 1.523v7.8849l1.5289 1.523h68.765l1.5274-1.523z" style="fill-rule:evenodd;fill:#ff7200;stroke-width:1.4659"/><path d="m115.17-40.693c-.33128-.45148-.37819-1.0481-.12019-1.545.25213-.45882.54383-.87659.88244-1.2489 1.0584-1.1507 2.4626-1.6784 3.8538-1.4424 19.05 3.0739 34.144 21.827 36.617 45.499.18323 1.7283-.24041 3.4697-1.1624 4.7802-.92203 1.312-2.256 2.0625-3.6588 2.0625-6.6814.01-18.467.01-27.004.01-1.0935 0-2.124-.51452-2.7764-1.397-.65376-.87512-.85313-2.0097-.54382-3.0578 1.3398-4.6717 2.0727-9.8418 2.0727-15.282 0-11.293-3.1619-21.432-8.1605-28.379z" style="fill-rule:evenodd;fill:#fff;stroke-linejoin:round;stroke-width:2.1988;stroke:#00355e"/><path d="m88.279-40.693c.32542-.45148.37233-1.0481.11434-1.545-.24627-.45882-.54384-.87659-.88245-1.2489-1.0584-1.1507-2.4612-1.6784-3.8538-1.4424-19.05 3.0739-34.144 21.827-36.611 45.499-.1891 1.7283.23454 3.4697 1.1566 4.7802.92789 1.312 2.2618 2.0625 3.6588 2.0625 6.6814.01 18.467.01 27.004.01 1.0935 0 2.124-.51452 2.7763-1.397.65378-.87512.85313-2.0097.54384-3.0578-1.3339-4.6717-2.0669-9.8418-2.0669-15.282 0-11.293 3.156-21.432 8.1605-28.379z" style="fill-rule:evenodd;fill:#fff;paint-order:normal;stroke-linejoin:round;stroke-width:2.1982;stroke:#00355e"/><path d="m84.683-24.305c0-12.763 33.839-12.763 33.839 0 0 12.757-7.58 31-16.92 31-9.339 0-16.919-18.243-16.919-31z" style="fill-rule:evenodd;fill:#6aafeb;stroke-width:1.4659"/><path d="m118.52-24.374c0 8.3833-7.5756 15.18-16.92 15.18-9.3449 0-16.919-6.7972-16.919-15.18 0-4.0253 1.7854-7.8849 4.9575-10.73 3.1721-2.8467 7.473-4.443 11.961-4.443 9.3449 0 16.92 6.7899 16.92 15.173z" style="fill-rule:evenodd;fill:#fff;stroke-linejoin:round;stroke-width:2.1988;stroke:#00355e"/><path d="m115.43-24.374c0 6.8544-6.1903 12.409-13.829 12.409-7.6328 0-13.822-5.5542-13.822-12.409 0-3.2865 1.4541-6.441 4.0472-8.7659 2.5946-2.3249 6.1097-3.6368 9.7744-3.6368 7.6386 0 13.829 5.5542 13.829 12.403z" style="fill-rule:evenodd;fill:#00355e;stroke-width:1.4659"/><path d="m102.18-13.34-.57901.01173c-6.7899 0-12.31-4.9473-12.31-11.039 0-6.098 5.5204-11.045 12.31-11.045 6.7972 0 12.312 4.9473 12.312 11.045l-.0118.51598c-.30342-5.2859-5.1818-9.5003-11.148-9.5003-2.1651 0-4.1865.55556-5.8986 1.5172 1.913.02933 3.4536 1.4321 3.4536 3.1501 0 1.74-1.5758 3.1487-3.5107 3.1487-1.9232 0-3.4814-1.3794-3.5093-3.0974-1.0774 1.5348-1.696 3.3495-1.696 5.2962 0 5.3489 4.6952 9.7289 10.588 9.9972z" style="fill-rule:evenodd;fill:#ff7200;stroke-width:1.4659"/><path d="m142.44 25.929c.57167 0 1.1111-.27998 1.4307-.75492 2.7089-4.0194 4.5295-8.395 5.3768-12.919.0924-.5028-.0514-1.0188-.37818-1.4087-.32542-.38846-.80622-.61274-1.3164-.61274-12.499-.004-79.415-.004-91.914-.004-.51012 0-.99679.22281-1.3222.61126-.33275.39578-.47054.91176-.38406 1.4146.859 4.5236 2.6796 8.8992 5.3885 12.919.31956.46908.859.75492 1.4307.75492z" style="fill-rule:evenodd;fill:#fff;stroke-linejoin:round;stroke-width:2.1988;stroke:#00355e"/><path d="m152.86 50.504c.4984 0 .96747-.21108 1.3002-.58341.32542-.37233.4808-.86487.41777-1.3574-.89858-6.3384-6.0863-12.334-14.722-16.932-.43536-.23454-.92203-.35473-1.4146-.35473h-73.447c-.49253 0-.9792.12019-1.4146.34887-8.6354 4.6043-13.823 10.6-14.71 16.938-.05717.49252.09088.97919.41777 1.3456.32689.37234.79596.58342 1.2885.58342 12.872.0118 89.418.0118 102.28.0118z" style="fill-rule:evenodd;fill:#fff;stroke-linejoin:round;stroke-width:2.1988;stroke:#00355e"/><path d="m45.694 51.632 7.215-.87072 10.226-4.506 5.818 2.2643 20.808-.58148 15.941-7.838 13.073 6.6477 8.9564-4.7875 7.2722 3.5621 11.034 2.9317 19.817-6.5509c-4.5515 7.3234-10.649 13.782-17.904 19.027l-44.762-8.2557c-.37087-.0689-.76078-.063-1.1272.01-2.7602.56729-14.728 3.0182-14.728 3.0182l-29.408-.33715s-1.1624 2.2266-2.1885 4.1909c-.13046.25213-.3093.47493-.52038.66404-3.4638-2.5931-6.6536-5.4735-9.5222-8.5885z" style="fill-rule:evenodd;fill:#83e23d;stroke-width:1.4659"/><path d="m70.59-54.115c0 2.9552-2.3938 5.3475-5.3416 5.3475-2.9552 0-5.3489-2.3923-5.3489-5.3475 0-2.9493 2.3938-5.3431 5.3489-5.3431 2.9479 0 5.3416 2.3938 5.3416 5.3431z" style="fill-rule:evenodd;fill:#83e23d;stroke-width:1.4659"/><g transform="matrix(1.0994 0 0 1.0994 -116.63 -103.76)"><path d="m154.96 64.181c0 4.1866-3.3959 7.5825-7.5838 7.5825-4.1866 0-7.5825-3.3959-7.5825-7.5825 0-4.1879 3.3959-7.5838 7.5825-7.5838 4.1879 0 7.5838 3.3959 7.5838 7.5838z" style="fill-rule:evenodd;fill:#6ab0eb;stroke-width:1.3333"/><path d="m145.2 67.296-.17733-1.5106-2.6413-1.208-.005-.04267 2.3026-1.7706-.17733-1.5106-3.5626 2.8906.13067 1.1413z" style="fill:#0077e8;stroke-width:1.3333"/><path d="m145.72 67.144 1.1773-.13466 2.0626-6.0625-1.172.13466z" style="fill:#0077e8;stroke-width:1.3333"/><path d="m150.3 66.701 3.5626-2.8906-.12933-1.14-4.1252-2.0106.17199 1.5106 2.6453 1.208.005.036-2.3026 1.7773z" style="fill:#0077e8;stroke-width:1.3333"/></g><path d="m124.89-71.447c-.0279 10.649.0865 10.765 7.4334 10.655-7.3762.10995-7.4906.28731-7.4334 10.657-.0572-10.427-.20522-10.628-7.4319-10.657 7.2721.02933 7.4041.10407 7.4319-10.655z" style="fill-rule:evenodd;fill:#fff;stroke-width:1.4659"/><path d="m95.498-69.209c-1.1272 0-2.2091-.41191-3.0109-1.1448-.80183-.73293-1.2489-1.7297-1.2489-2.7661 0 1.0364-.45148 2.0332-1.2474 2.7661-.80183.73293-1.8851 1.1448-3.0123 1.1448 1.1272 0 2.2105.41191 3.0123 1.1448.79596.73293 1.2474 1.7297 1.2474 2.7661 0-1.0364.44709-2.0332 1.2489-2.7661.80183-.73293 1.8836-1.1448 3.0109-1.1448z" style="fill-rule:evenodd;fill:#fff;stroke-width:1.4659"/><path d="m101.57-65.298c-.56727 0-1.1111-.20669-1.5054-.57315-.40164-.36646-.62445-.86339-.62445-1.3794 0 .51598-.22867 1.0129-.62446 1.3794-.40018.36646-.94402.57315-1.5113.57315.56729 0 1.1111.20669 1.5113.57315.39578.36646.62446.86486.62446 1.3852 0-.52038.22281-1.0188.62445-1.3852.39433-.36647.93817-.57315 1.5054-.57315z" style="fill-rule:evenodd;fill:#fff;stroke-width:1.4659"/><path d="m84.751-57.689c-.83554 0-1.6374-.30343-2.2266-.84727-.59074-.54384-.92203-1.2768-.92203-2.0434h-.0058c0 .76665-.33275 1.4996-.92203 2.0434-.58928.54383-1.3911.84727-2.2266.84727.83554 0 1.6374.3049 2.2266.84874.58928.54384.92203 1.2768.92203 2.0434h.0058c0-.76665.33128-1.4996.92203-2.0434.58928-.54384 1.3911-.84874 2.2266-.84874z" style="fill-rule:evenodd;fill:#fff;stroke-width:1.4659"/><path d="m61.738-51.516 2.6283.32102.08062-.62446-1.5113-.18323.57755-4.7113 1.5054.18323.07476-.61859-2.6283-.32102z" style="fill:#4bbe00;stroke-width:1.4659"/><path d="m65.403-51.069 2.6283.32102.72707-5.9558-2.6342-.31956-.0733.6186 1.5054.18177-.57315 4.7128-1.5054-.18323z" style="fill:#4bbe00;stroke-width:1.4659"/><g transform="matrix(1.0994 0 0 1.0994 100.24 -125.51)"><path d="m55.525 76.43c0 4.1199-3.3386 7.4585-7.4585 7.4585s-7.4638-3.3386-7.4638-7.4585 3.3439-7.4625 7.4638-7.4625 7.4585 3.3426 7.4585 7.4625z" style="fill-rule:evenodd;fill:#ff7200;stroke-width:1.3333"/><path d="m48.936 74.019c.21866-1.1253 1.188-1.9746 2.3439-1.9746 1.3173 0 2.3906 1.0986 2.3906 2.4586 0 1.3546-1.0733 2.4586-2.3906 2.4586-.60932 0-1.1613-.23466-1.584-.61998.44266-.17733.76131-.62532.76131-1.1413 0-.68132-.53732-1.2293-1.1986-1.2293-.10933 0-.21866.016-.32266.048z" style="fill-opacity:.21177;fill-rule:evenodd;fill:#2f1500;stroke-width:1.3333"/><path d="m48.936 80.217c0 .68265-.53599 1.2293-1.192 1.2293-.66265 0-1.1986-.54665-1.1986-1.2293 0-.67732.53599-1.2293 1.1986-1.2293.65598 0 1.192.55199 1.192 1.2293z" style="fill-opacity:.10196;fill-rule:evenodd;fill:#2f1500;stroke-width:1.3333"/><path d="m45.676 71.977c0 .34399-.27066.61465-.59865.61465-.32932 0-.59998-.27066-.59998-.61465 0-.33866.27066-.61465.59998-.61465.32799 0 .59865.27599.59865.61465z" style="fill-opacity:.10196;fill-rule:evenodd;fill:#2f1500;stroke-width:1.3333"/><path d="m48.583 80.586.79065-.45199-.39599-.68265-.34799.20266c-.72398.41199-.92798.43199-1.1573.037332-.22266-.39066-.39066-.76665-.64532-1.2093-.34932-.60932-.76531-.65065-1.5106-.34399l-.01467-.03067c.63998-.48932.81198-.86931.46266-1.4786-.25466-.44266-.49999-.77598-.72398-1.1666-.22399-.39599-.10933-.56265.61465-.97998l.34932-.20266-.39066-.68265-.78665.45332c-1.2346.71332-1.62 1.2973-1.14 2.1306.30666.53065.53065.70798.80131 1.1773.15066.25999.02133.69732-.95864 1.28l.43866.76132c.99998-.55199 1.4426-.44266 1.588-.188.27066.47466.30666.75598.61465 1.2866.47865.83865 1.1773.79731 2.4119.088z" style="fill-opacity:.59608;fill:#833a00;stroke-width:1.3333"/><path d="m50.515 79.477.78665-.45199c1.2333-.70932 1.6186-1.2973 1.14-2.1306-.30666-.53199-.54132-.70265-.81198-1.172-.152-.25999-.02133-.69732.96798-1.2866l-.43732-.75998c-1.0106.56265-1.448.45332-1.5986.192-.27066-.47332-.29733-.75998-.60398-1.2906-.47999-.83865-1.1773-.79731-2.4119-.08933l-.79198.45332.39599.68265.34932-.204c.71332-.40532.91598-.42666 1.1453-.03067.224.39066.40132.76532.65732 1.2026.34799.60932.76531.65198 1.5093.34399l.016.032c-.63998.48932-.81198.87464-.46399 1.4786.25599.44266.49065.78131.71465 1.172.22399.39599.10933.56265-.60532.97331l-.34799.204z" style="fill-opacity:.59608;fill:#833a00;stroke-width:1.3333"/></g></g>'
